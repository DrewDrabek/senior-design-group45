
# Endpoint JSON
{
  "endpoints": [
    {
      "endpointId": "endpoint-uuid-1",
      "provider": "AWS",
      "name": "my-s3-bucket",
      "region": "us-east-1"
    },
    {
      "endpointId": "endpoint-uuid-2",
      "provider": "Azure",
      "name": "my-blob-container",
      "region": "eastus"
    },
    {
      "endpointId": "endpoint-uuid-3",
      "provider": "GCP",
      "name": "my-gcs-bucket",
      "region": "us-central1"
    }
  ],
  "TotalEndpoints": 3,
}
# Endpoint Add JSON
{
  "provider": "AWS",
  "name": "new-s3-bucket",
  "region": "us-west-2",
  "credentials": {
    "accessKeyId": "AKIA...",
    "secretAccessKey": "encrypted-secret"
  }
}
# Endpoint Delete JSON
{
  "endpointId": "endpoint-uuid-1"
}
# Access Policies Secure or not - this the list of endpoint and if they are secure or not not the json policy create another json object where users can get the policy via response if they want
{
  "endpoints": [
    {
      "endpointId": "endpoint-uuid-1",
      "name": "my-s3-bucket",
      "provider": "AWS",
      "securityStatus": "insecure",
      "issueCount": 2
    },
    {
      "endpointId": "endpoint-uuid-2",
      "name": "my-blob-container",
      "provider": "Azure",
      "securityStatus": "secure",
      "issueCount": 0
    }
  ]
}
# Access policy detail

{
  "endpointId": "endpoint-uuid-1",
  "policyDocument": {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "PublicReadGetObject",
        "Effect": "Allow",
        "Principal": "*",
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::my-s3-bucket/*"
      }
    ]
  }
}
# Data endpoint - this will say if the endpoint that have private data in them

{
  "totalEvents": 187,
  "securityIssues": 134,
  "configurationConcerns": 53
}

# Storage Size of endpoints

{
  "endpoints": [
    {
      "endpointId": "endpoint-uuid-1",
      "name": "my-s3-bucket",
      "provider": "AWS",
      "sizeGB": 505.5,
      "objectCount": 125430
    },
    {
      "endpointId": "endpoint-uuid-2",
      "name": "my-blob-container",
      "provider": "Azure",
      "sizeGB": 200.0,
      "objectCount": 54320
    }
  ],
  "totalSizeGB": 705.5
}
# CSPs that are in use for the organization

{
  "providers": [
    {
      "name": "AWS",
      "endpointCount": 15,
      "totalStorageGB": 2500.5
    },
    {
      "name": "Azure",
      "endpointCount": 8,
      "totalStorageGB": 1200.3
    },
    {
      "name": "GCP",
      "endpointCount": 5,
      "totalStorageGB": 800.0
    }
  ]
}

# Private data endpoints

{
  "endpoints": [
    {
      "endpointId": "endpoint-uuid-1",
      "name": "my-s3-bucket",
      "provider": "AWS",
      "hasPrivateData": true,
      "dataTypes": ["SSN", "credit-card", "api-keys"]
    },
    {
      "endpointId": "endpoint-uuid-2",
      "name": "my-blob-container",
      "provider": "Azure",
      "hasPrivateData": false,
      "dataTypes": []
    }
  ]
}


// GET     /api/endpoints                      # Get list of endpoints being monitored
// POST    /api/endpoints                      # Add endpoint to the list
// DELETE  /api/endpoints/{endpointId}         # Delete endpoint from the list
// GET     /api/security/policies              # Get status of access policies (secure or not)
// GET     /api/security/private-data          # Get private data status
// GET     /api/events/summary                 # Get total number of events (security + config)
// GET     /api/storage/size                   # Get storage size of endpoints
// GET     /api/providers                      # Get all CSPs that are covered
// GET /api/security/policies/{endpointId} # Get detailed information about the endpoint access policy
